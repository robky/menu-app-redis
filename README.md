# REST API по работе с меню ресторана
### Описание
REST API по работе с меню ресторана реализовано в 3 сущностях: Меню, подменю, блюдо.

Зависимости:
- У меню есть подменю, которые к ней привязаны.
- У подменю есть блюда.
Условия:
- Блюдо не может быть привязано напрямую к меню, минуя подменю.
- Блюдо не может находиться в 2-х подменю одновременно.
- Подменю не может находиться в 2-х меню одновременно.
- Если удалить меню, удалятся все подменю и все блюда этого меню.
- Если удалить подменю, удаляться все блюда этого подменю.
- Для каждого меню указывается количество подменю и количество блюд в этом меню.
- Для каждого подменю указывается количество блюд в этом подменю.

В проекте используются 2 сборщика контейнеров: для рабочей базы (используется внешний порт 8000), и для тестовой (используется внешний порт 9000).
Контейнеры работают изолированно друг от друга, и не мешают друг другу. 
Соответственно можно запускать их как по одному, так и вместе.

### Изменения
Рабочие и тестовые контейнеры теперь работают изолированно друг от друга.
Добавлено автоматические контрольные тесты перед добавлением в git.
Добавлено кеширование ответов при помощи redis.
Написаны тесты для проверки кеширования.

### Технологии
```
Python 3.10
FastAPI
PostrgreSQL
Redis
SQLAlchemy
Alembic
uvicorn
pytest
docker-compose
```

### Подготовка к запуску:

Клонировать репозиторий и перейти в него в командной строке:
```
git clone https://github.com/robky/menu-app-redis.git
cd menu-app-redis
```

### Как запустить рабочий проект:

Переименовать файлы .env_prod.example
```
mv .env_prod.example .env_prod
```

Заполнить файлы .env_prod актуальными данными согласно примеру.

Запустить контейнер c рабочим проектом
```
docker-compose up -d
```
Проект будет доступен на 8000 порту.


### Как запустить тестовый проект:

Переименовать файлы .env_test.example
```
mv .env_test.example .env_test
```
Заполнить файлы .env_test актуальными данными согласно примеру.


Запустить контейнер с тестами
```
docker-compose -f docker-compose-tests.yml up -d
```

После окончания тестов, контейнер останется работать и будет доступен на 9000 порту для postman тестов.
